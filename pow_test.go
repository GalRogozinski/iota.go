package iota_test

import (
	"context"
	"crypto"
	"encoding/binary"
	"encoding/hex"
	"fmt"
	. "github.com/iotaledger/iota.go"
	. "github.com/iotaledger/iota.go/pow"
	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/require"
	"math"
	"math/rand"
	"sync/atomic"
	"testing"
	"time"
)

const (
	workers     = 5
	targetScore = 4000.
)

const SmallMessage = "010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000be0000000000000000010000210fc7bb818639ac48a4c6afa2f1581a8b9525e20fda68927f2b2ff836f73578000001000001db0fa54c29f7fd928d92ca43f193dee47f591549f597a811c8fa67ab031ebd9c390500000000000000000000010000016aa4e9829f224be8eaf66726c9077cb41f79019d892be99303b2be5882f3240758a38d7e4127dbfd477a32f5fe708a29bf062801c3f957763eea0daf62d65dce5ba524f7358efbb5b83220cf58636cbc40cfac9aeb3cc847bcdcf10f717aa2620000000000000000"
const BigMessage = "010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e23600000000000000010000210fc7bb818639ac48a4c6afa2f1581a8b9525e20fda68927f2b2ff836f73578000064000001db0fa54c29f7fd928d92ca43f193dee47f591549f597a811c8fa67ab031ebd9c000000000000000000016aa4e9829f224be8eaf66726c9077cb41f79019d892be99303b2be5882f324070100000000000000000158a38d7e4127dbfd477a32f5fe708a29bf062801c3f957763eea0daf62d65dce020000000000000000015ba524f7358efbb5b83220cf58636cbc40cfac9aeb3cc847bcdcf10f717aa2620300000000000000000177ff0a3a0ec73e10ff408ece8728f84ae1af7bbf86e9946fb08fb658975ab552040000000000000000019d704074af4ac8c0f5a46f096ee8477a775430038fc00eac03af4ddcd325bd2b05000000000000000001313106348a08b86422f5ddac84877a488cafbd6ddc080f1dfdc9c4ad256f4756060000000000000000012046fc4054f59b5be5465e75e6e0aa60c8eb2ee5d4cd2650a81ccee35507a11a07000000000000000001379071c751f71fdf0dfeb3fbc8f00825e64c2762fac9fe63e242037a8bc40369080000000000000000016e07334237104c5ec5642ca3c1c2550a8716a928e7cdbaeac9bf2500984945cc09000000000000000001e5da4c6fb4829dbb669f614440f7192e14ea5fba492c9556d74088a9132e4a5c0a00000000000000000113cc159aa6eb4a0e9b963cadd16e9c2dbafdce26c718bcdc0fa7d4ad155eebcc0b000000000000000001b94671e3ddfb4b997d5b3fe4a48b598e7d89dfff840daecaa89b8ef231f6f27e0c00000000000000000113daebe2edcded9f38c69e7f7aa1834eda01e335412010a6117c755c2a7b4e180d00000000000000000129aec7c506c16407cc17b08fd5d2e3506a9a4804a3ba7b22d1157d2a8f5e358e0e000000000000000001fd263d98f01018d71edc1d543a4df3eddb1946f85bf3e52c4bb680084d2771580f000000000000000001aa81281c8ab5476a841bf223c1c06e51f9b51980cdf8066b31f623841cb6bfea10000000000000000001599bd84f8404db4b71e4aef2d6e92a16429e0cfca68479c82a23b37929ddb57611000000000000000001194ed12aae2179028e906fc7f1f064d1620bbd5b491c141ce69697973c7670f4120000000000000000013eba3788b246bf22e9a2847a3df212c9b528150a314efc130902413fcc8e0b0613000000000000000001d1a3806e481200a7d277cd9db591130a45bbe3fa0fc78f4f4c3cb3c1d7c892b114000000000000000001320b072127600af544db908c62bb20b1843bdbafdb44432b8946750155d770df15000000000000000001f3fef818c43cd5c8d8324bcdc096388fe7d648b301ce0820e4bd27210a77345a160000000000000000015074d556cbe2cb7a635fe3045287a8163d78e5c3828480c967d434b4afef9f91170000000000000000015e1b8df54324b4dad0bac0eef194a1e8acdb84b8dc99624b19d1f8c5487eeb9f1800000000000000000182ffe9a488865c28600fa3a70b97fe4c991708b5589421d8153691d3621d404b190000000000000000015d3fdf60f242df5f0e89989959d33d7e614834a6f7d571211f5d73c4cf930b9c1a00000000000000000162d3d20f5368fc221b99916087459c5641661c3252b0aaa165ed1d0f3e405b801b000000000000000001d1e86b4c1a7eadc27736a502012198921c7acb683b03fcc967f77765e7fa5ef91c000000000000000001e5922a977cac82f5eead81f4b9f0f7a79c91c6514dbcb6e236cd85a4bbad18331d0000000000000000017d9ad6829a2652dec1c5f3466ff1042adcc225bf318118e56fade0602cac62f21e000000000000000001d559b926ae4d67867b23a2cbac6306b2e32f73596479ac7415f25114fb4506bb1f000000000000000001f0295ad2906f24b98f0654ae56333d79924250cf1653cbc6574517ea6940accb200000000000000000019774a08a7940a12e63ca61cd982bcf553acb038d5e03a92d3ddd3932054026fc2100000000000000000173d7aff8c5716b40b5328acc20560b1b64a3373a54d76e2b168e92e5c1ca2be822000000000000000001008a64bf5c3f3ff63c118034843ee404517c54a00759d32e193e1eae16472ff523000000000000000001f119b6a1362dfc1b8613e0f4f968579d1fdee512d19447d8e52aafcee0b798b224000000000000000001e1eea57a89b4068b59d6bf69564bccc004a2ee74b491c9698b8545bd6a29e5362500000000000000000162d41a78980cdfa085ba47c296cd76cd5c93a408d096395ce10205bfd57bf8d626000000000000000001cd5d306ed23128eb5c3c4a95f13fb6a8adb853c8ed3d9db4c22fe579943f153827000000000000000001beeb519bb96f6ff14fa67fb4d01bf78af7ccd83617d49aaeff0407aa86c6123128000000000000000001778a5b150beb1ca4f8a212d881a2cf94a1e027a259826185ec8aec6b45cd861f29000000000000000001ca0f22cf6f2a7e0d8c21e28cb9ad576474599a317d463ad315eae73abcbfe76a2a00000000000000000136f2997a5f09b23ee5d67d847a62b3d8c384424059be8a59c735d7c9b26fdd672b000000000000000001043b20dc276382343dbce629451594c90cfacf0f355806125118e7421139b3b42c000000000000000001ddfe3fd754b0f356617dc409a21e36fafa16949c4ffbd625e8cd9a8efc61e72e2d00000000000000000194d6b241ddb1b4e5031ce6cd030680279d7e066d2942ae448da3c98503f14d482e000000000000000001b6c7dfbf877e58b192870506e16e0d155199c56c71cffb8fe2d3a231904f389c2f0000000000000000013ad750d07570338b6244239e6a8ce7b2ca843c9f577051a5bed44a3a61e84e753000000000000000000125cd4e725c69b35b74f24b769c8bf0eef39d4a8c9624d08c51d9023f84e494a431000000000000000001ed5b07d6efc008dda98e5699cf4b7f694f3d6886481b9e94ffde36ddd1bf6948320000000000000000018dcf2c2aa0a2ffc9d96a993d6dfa3979ac87c1afce2acf0984fdc1e6c4272e4a330000000000000000014c640fbc81faeded2329026ff581c5183308c87fe0d090c01277eeeb6a6c110834000000000000000001a0bbf29480a198bb44dce407991d541858143993aec2dc0ae5f46385d3cd073635000000000000000001855fd6f0db8ff1133668021ecce06639aae877b99bb1dfcd2421cafc1532fc71360000000000000000014153203c9a265e35586e97c3ee5a8f6c269cd9b054ce573ddc4156e6be7a20ef3700000000000000000104f6144f21785a5566a13df87d5c103c3f284c05623fdabf11a7028ec84fc24a3800000000000000000186e4fdd4ac3710d7600597e008d8b6aa08c9d51f0896c5945e79b221f19562be390000000000000000014c240b1cbebf0f2dc89b6ef47e3b8c415d4124f4148c75cb0d8e08ead9e5843e3a00000000000000000154a0d922f5b80ded3a7f9306f8c84a6015650643ff3a50fecee0151f037f2bb13b00000000000000000104079ccd9beacec7ab96d5428893bbd02b7406683ee280da781094473c7ba18f3c0000000000000000012755d737a95fdd1de1f403a899c2d086613aed70dbbb74aea52c16a0c780878b3d0000000000000000010af18f989d6001c2e06278dde887a5cabbc89f2faf66e8b9480d31b58eaa486a3e00000000000000000174cbc59e1c1de51d890a4b1012aafb086b10625594a138b04d3fb1a8fca20e6c3f0000000000000000016b65732d614724b9bba04af805f4741b069993634af79d43230030395a658aa44000000000000000000113f16a29b71624dddbf775059448765fc98d5227175b7b9e7a2a8a9ad255206d4100000000000000000172e8895c9e6148581b6480948fffabb35812917debba4ff2016bcdff44b7d7c74200000000000000000119ae129a654818d710302d7276c1974ec291403092475ecbc285baf4ef473d70430000000000000000012d64d863adb296c4f11a57b2abf46e1e4e4e9332f16c761fa1aed65a271d37a9440000000000000000012b324af62947c02969cea96493bce4f0cd90dc205348f3ddfb17d1d568020a5d45000000000000000001568d658d13da854e183e69839a00fa3312cba15dc36c6a85bfa2493c0416d2f2460000000000000000012eca8420299d540ce24a7d263654c27b723d4aa66eaddef79478f5b57d24b29c47000000000000000001c45ea5e2f62d5c7d8d32474ac651ba6680a4f922f03e5109ad1e261ec50c2afa480000000000000000017adc8a6ff23c0ad4ab251ffd1ac19e358d8aaa05da97e348fea6f48a3790bab849000000000000000001b3e9caec4e7590d40c11ed78f461c247094b98dd2af59f2499714a3e0eb0efb04a000000000000000001aa6c61b2f6460fb5943e644a5b55f416f065b474d93f07297e12bff6c1390b1e4b00000000000000000133c065ec68a21ebed15a66c2cda6f246390384e1f97246f53ea33b49470db2ba4c000000000000000001435a6b52f201993fbb0fa35595b35e95eb50275f839e13cdb871b8824917fa394d00000000000000000191a7b2d2d860362e5d8e1eca9eb2621fc35cd064c863d9532f2e5e6d03c6b1fe4e0000000000000000013aae993c479134151c95e4d1d0c0e7fd663533c303aa77cc1c7792b9a2d7e4ea4f000000000000000001d14a74f4054ccbbfeb98208f774daa13d6b1cf809d6bdb02a9a3d20fca4ddcc55000000000000000000158103d9682f100326b25fc0ea66bd7e5c21a0b39d5dbf553e2dddaada8622b1251000000000000000001005328c723bfb46d5349b70634339926c8163e5f8e8726de13bdbaea1a03cd2e52000000000000000001ac7d79fa254faf5bc4e46a503383ccf5493ecfacaa948933b6c477bfafe6fa0753000000000000000001075b8e6b8bfe1ce320f317543f3899d4ab85e77d47e34198e95bf43818ee1364540000000000000000012ec35f224241cb6259be37ca49f3c10accd4d8570c41f39aaa890fe80c6d7b785500000000000000000143fdea8ca79b7523fee6e32f43e065bdcad1d8441a372cf8b317830e12db239056000000000000000001839cbf7d165e28ca6e86e0096171e5004dcee18aa8bdb1d5c4f2ef0bee076a12570000000000000000012fb12b5d0bc4d3e09ac6dc257587c8b27bae6ac83cf92ac6d7bd6d889182ab0158000000000000000001a03c3ee25b22b9f44013276d10c581ee91f96d0002ec77bfd4b4620025785e0659000000000000000001b0473b35d729e8d89d5f0411026bde9e4f4bf9977501b649e548ff342ae6cf5d5a000000000000000001856df8358cea04b3105b07803bd5694ed2a59f6a3877585c79eb03305c5d7d475b000000000000000001d1d3aec2e8b5693558d5c291804e1b8792b26069026f471b89147e4fe4f9f04d5c000000000000000001bd767236f3d8b84daad6d4e999db351db0c7a08a18e26665d4a4fd467b38a36c5d000000000000000001762e87ce9d1cf787d80ed46b3d01846cdef772c4ccaec4f435bddca5694fff985e0000000000000000017d30be40e739f6fd5219d951b404225c93077db9f05d53676eaacf2816142c285f0000000000000000015ab920d38c42fc6de5684784bf4d9c55625610aefc1e918b525249253c6fc05960000000000000000001592d80432972278755f6880b3bf4a26f5e71a106463476e8229f812a33c2c3bc610000000000000000019d2a36b49236029354b98632c10c75c43be40a3fdf4ef6054f3019a6e9e655af62000000000000000001e8c43fffe340c1a2e105d77782d5f9a60f54ed96a068ecae57e36ad2ce189ac2630000000000000000000000640000015e103c215c38a9c48276f9a99b33434061dd0d839ede084c1333826af4ab611cdbbb798428b7dc9a65411bb2827e20b863fcd500bd19b6cb0a64c1efec6709e19a2ac2c5d9c73d2a493ef430c9472eecaa46da3162274fad4c50cd835137098b0001c76d62fec3e991e5e84d111bde0323aa1e65ad062328d2df594752f23fc7685020f32ac0fbbbc0ad26a675191bd81ff9fd33102c1580dca7f6f45054f23bc6e0534de3b8497242907136828d06a22c8b2a31729b7b566bda9ed9049ae75e852500010b1defb8656fffe56f02a8e29b18c2118a7eb5df72440cc78543c5753a2b1fa57566421503b32f90cb2b568e2eb198d05d538d7cf80e0798604e8d69f92ed79ae24d3749b9595d2dc27e507b974f062bbccb103e0ed3f87e78e5761f21f939f40001879c12e4ad86b6a6ab174484d5d24ab067d452ee85df00c1e36576469952dca5265c3162ebc2cdc72712e4fcc556b5db873994fb3d3124b7164d6e518e478effc05809c3e7cc5ca8820fe24dd26dbf9b3d28d6656d0a051bfa669cf615ce50e1000121909ba0dedb767cb62d30ebcd74e51918c07d43a36120955223ecf051bf4495278401ae480c08b5b6ca5f8e5576a8a4d7c611b0670e66774d4edbebdc053baabbe87159d47153bef4782ab89f09bb182d89d7df15b9d66d903f2bbff7c7411d0001caab5241216fb1f12fcdc885c3d78082fb86143e34953e82e2145193feee0af2fede97b7ef1f955d8fe859c95e9b9d350c84547d7d304280cc43a9843d5b0ba455f280a37511664c38ff17372b97be74d892dbf233a48b06d6c5be2d6b2b8233000175a7d4362f4681e1c7bbdcf91c93f8ebfa14f3d2cbd77024aa92e5b3145f1814ecc35bf033e7f6a72d0ff70a84d187efddcddca8a1ef186fdb0579d6f933899a57b7acfe1c49a56b5d15191f743587b3ddf69159ba95a780e0771d1d53d6567f000143da86560ae08c6ad34754b6377faceedc02b664d598ba5405834eb1c65e026f123ac4d499f8f44ec55f69b9eeffb05a1069ef9582a651ac06466a6980075adb0b5849d39bd666fc140558469816c03e50dbd768c1fe16a8e68021bac189b7d30001cfdf3e5eb07625b0b865a157352b793523707a120d5bfa343693834027e3c1a953fb3cbaed7d16b1837526449dff6d96220ad1f2e781d8ec90fd7452634a3c34db1aa8dfa5623457322c53ecdf03fce0860324cd4436dfe22f5525d627f32edb000138315dac2c280533a2fb0d7c021b8ad4dffc0269c42c656f8ca42f1904bec50f8cf0b18a2e5896c3871f894fa944e4f16fa9a631dd1c0a89d0d35cb37150daae0f0f587c1b875ccf93c574e27308b2ddb8d7d5c3882f98a2b84298e2fdc67f6c000147e6c59d3031403c63e7d1201e85f94098e89f31df9e14eeb562567f883fe1d1ebac09cd71f82307da373237de6521729b899bec35bc6bb82000f6a906dcace8c352892074c9b3cc72450e7630692e8f9ae08fa66c16ee73ff93507e5d71d63500011e94ca4e83601aefac614c224ae3fcef322adb5273c3eba6f0ae351d0cde1d3841754bf362987307b958833829e3cd38baf059dc74e4e4176c83bf52dbeaf5fabf1dba13edda936ecb891e8372c5283a5f8dafdbdd6ea9d2764b7f4ad80ebfe00001c65fa0777a2b789e6ea4dc5ab0c2339ea168e2e42eba5e6d89464df57a2c77599844e0d5785ffed144adcc7846693bd5c203e124548cab0661787889428b1c9ea113c809ab7ed6c6b2af4d1db485b55d39238e678d48a11b42ddbdcb53a820500001f744e7bc7a85097104cf81cab410f2bfc77c05c3621979047ff854850e35e4644c22e0a6cdc1273eff74b72e29b2cb88ea79b65fb82f1eb850c1f6d4d433d840c95eb5299e6065b4d2684d3f7e0dcbe69e0d2a4cf5d40d203617cbcd2aa4be080001487cfe7728dac0ffac48f5cd34cd1d6e1319dd0df178415987db1344c1e0b79c18f94e095399959d7c0edbf57d5520196a3930c86ee70eca024eca4667346e7b369c479c58f4202c489d901d4a46a4e2ea985287f95218099ce3f63fa5edf70e0001b9494788476211919add332cf9770cfe5dbc11250c57412e266a84f46b744574061faf0e4d5abf4e026ef57ba4cd5ffc9ba37d8d3511ee636be1c851db7994424deaaebdc0240c283bcb2d671038998ffa9d76c5d9850eda456082f21b8fbe020001cf20f9204bbfe80ccaf3dac78ec0139d3c21e668d66664e0819856b5f4a81e126fb017e791f96c829f22e2155ace737129698f94c7b34f1b1628e7d67e5fdeb693a8db9b4419dce757694fa9334c165a91e46933349392e000a2f2fba9e0b5e00001c09d3952d6a445b39e965144adf070517da79fbb20410c9430cd8c3866538b3eae3488b32888d7bb2b4f7114296324a1a611eebb60439a10da7dbb9dfc677ee557368cb4206d5ad1611f1b1f237226b1ff1226bb6d2b7a7e155a2f0e17ef71cb00011c18d0fe009fc60cb745edf7b993afa502b6fa8d7cf62c369a81b8ce8963ad265c3b1bf7b8aeaf5c07473c79140f1835aa30cedd771f91956f88c1a893889132d3db73ee24d757538712d8c85c57648105b0444dadf6c54984427c1c52ab5eb40001b1052a91e7ad2c178fceb50a3aaa055736fd18a42f3214ae605dee36bd7b1f6ab510260a19d12553ea97f39ce6711ea633986c3eb4bd1d5bdfabef5dde17b0627d718a36f55bd29254b7d01bad7569a05a77fdf281f55c9675956b26778630390001af32d03e1b86f6dffd7e0c0a46323a2a4cd8817d8836a90dd2f71c9cb9e86b6d1da589169520424659d04bef6a1ad692ff34447d2d61c6e1ad7564dd00da0f3eab4d1b795502c8f68cf04fad643708dc054ce03fe60e6ac95b828b542b280fe50001414a5353819c2275d42a9f03142d4698bfaec2154ad1b74b3ffe87e2670b1ed17ff2b9153f89b02b72a2b5ba1fa087efeee5017f4666057ebd0b06433da2cc6ba1b5bf91a76c44c7b77abe20e9b1a7f9582e925fa2d51098f9581f9184ceec53000142e5bad8c93c5b4f7a8dc4fe6e560a1a082bd5ff8f28ab6ab36c8a0f2ba573edc72cb9b7fd9ccae74eba727d1df1b5ec8463da619d5a3b532baa6cc4c4cb88d851715e8eebed77fcb957aac6f4eaf759a33fc798f26aa10c08e5548a6924e8cd0001d22774c696641d007621a14fe8cf42fd5186d8bda9280042e94bcbf5cf20fa962f39861b2273156578feb912cd702c8de64b083cbb6296f9c31829b601ef76b6108d0009c8bdc99618cd97b5b850c9b6f62f05b3961cadfdf38fc89b6b92139d0001cf4b63e282a4a3186b5b1eaa558dbd1de3a5ae2641ba07c585a2b0cca9906ba407bfe3011f0d73bdc4ab03c0d7ec47ce219c433b88d4a3de497048478497d8033474264b0e523218df36d234a19c04978310c232f85ad2cbd83b3558860089de0001f57c1afad6e77b337c8b34e6679027799e0c7966aec3e54f2acbd7c5287ca666f1aef5c20eca71cb22e0b5a66ec923bed66a168ec1009bd759a78e68411355ad6ac949e16a17be8ba3fc813bfb88cb1c663f662884b4bffdac657f80679832bf00016edcbdcd187cbb54f9ba66796a39c1550e2c2b08107f0a8afae3243199feaadcbfb68a24c2b1419477d0226fe93c19c28f920a883f71ca9c8d3469509d23bde75b7f459ad4d86206cd3e7f32b5412512d213c991444986508ecf381e8565cb6800016aff1e03280ab093b6d5501504b16c71f1e7fec91089d6ce3f4fff2fe8e7d1881974efc4d8aa497709e9735c75cb2f97b2f78a711cc59d72166618393fbf6e83893c2602bba886446d8df554f80def78c3f7fb6160db66393f83cf728833fbc800012f5d9e20d3f38b9dc9e8ecc177d076ff95840e97971f626b24427239755b1c65a49143dfca1d4f15641ea5fcbf4b2d5dd93fc8d909158171f72d0cade16f7692481ff763c54e9b0eb71fe39c711d85b623483d5b2754d0e6ff667e2a45f211130001c76cbb17f5877bc3e2a5a9191b91584e1b874f7c8f63bd4a79cc5b8b94d109ecea0358a1ed5c7241be2e84521fe0200f6e343cefc2d41b4c5299334f53b0d7544b592eeb0459aeff4e47e1068fb2f2b2b4733bda65bf0474abe08c51047a687d0001fef1f1c687d920ee9cd705b77fb29ec7b71e2885e086a83c06d185deef8968fee215da0c15bfdd08cd34116ec7fddd5128376368bcc26e0be71e5a9ee464b1f737a7f81b6ed3992ae44243a75ed0021d64729926f576d1d50d113071584fd3ab000173bbd01ce9ca3741a1f67613d67af2a07666c33b3a9ce828509a762cfc482a23d9f4399fc18549fefd2c14733d08e9159ec186a527ab9dc6da8ee40c1918837765180a4c25991ff2c6b40cedf468b1e87ddefa7d18915fd56a700dea2c703ec20001176569b9944def6147fb07571460ee6f2c502cdc56ac5a1ea63daeebeb52a08feb2c01556b7d291506b9129e881506e58177613e6a0ee4a9e273787a043a8eb2683e97fe8ba7547c44cd50758d1e3cf80f097a30385176ad230527a3db3d99f9000147fdb8fc5e438d767a85043b1f149c3b12aba71e569c0f6bd7065396d393664851473b8b736d5625e137335e5051d5a2df367108a445a2d87ae4712c8f2f581c92533672d13eeddbbe816ea53c88e686a2fd2cece2873c4ea8b930b6d244fd7c0001dd9d687ee3c0e155b546ee6e3aecc0ee1ad5559a7b27be8881cd9e9da738d118733ce25a98b24867aec6505bdc8f1718fc74b0a26b8804433439ee824911ce5579c0bec59a68a7c3f3106dcc365ace1802e03f72cf15bfe68e53a8e8c78af23600018f23b4f12af2bb123e89da20087008c3d7298729a93c63287b85e458919a28cd523d8f57c6e6d2c74e8c8c940b5d88aa39b8bb266149f2cd48a059e547970a27fb68ab678dab9234dca7574783fb4c082d84ed7ad17a8fdf10aed458ebf769e80001944197ac78049c5eb3b90ce348c5451abb8d21a04b77e101066d8937d8b9cfd394d0fdf8e2c5333eaf7f9bf1de2df7103abad917f8797af4ac44605e2ea587c99c7d0a42acbf900a83b928f8b3b09626b44005244152ccc97310e5d3d3ece3f700019513f0c46e1451a2cbc575fd6daa55358a0c63d7d06a885678de38a8aab03a8ad4cc919a6da2c9a53aab4cc4fc3cb244bb3cfbf8628290f85e6a3c6a14617ea80c3b7f00f81814bd13a3c6e6f1b09f91f716c9db9dc8b896a02295f3398ce86d0001dce275adc3c92e2adc8873d9c04282a6ac4dbaa8e925bc3c385c77b9054a1fa010a2714f7351aa39c94ff76e453507377828440114e7ca39718b934299238b38342fd959f7fa8f9699234d5d6df2ddeb60f67f01ba5dad7ed22c34111ed777ae000159528bac489ff326cf56e2165615b1dedc0e00354a59725644d722772e78263e0ef2b7375b86f0f57ab17f7f72cbe09975439c60dfbc2b6811d750fb8b19f8e76defcc78919877ad00a76f3525a88fc22e071c950910edcc863cf1042cc6c6e7000189c17f3416be4547d8e78474309136dd8800b97322a9f1725f6b611f09fab88fe124bbdfb943d8463e4cd97756d54f987d61d6fa27b6a1958ab2406e1fc2c812ceda70628ee52f665cf07d728250a5e4e28c85e035c70d6263cb0bbcea8e98fc0001676a13541090e9af4da528ad14d36221814f1540653237398c7138bef8376b965a2c196ff3cff908c34bab9cb3a2e76261bc5983955b220b1b7d7bdef796c03029ef4e46e88d24fc0b5ec1406ea681b1661578edf63a6d3bc6293b29ad613dad00014687768de0dd8d4ffe9c1ea6737b8154c3fb6c88b2eb6500a44f096b77dcb375da0cef14657b1bdf211eba98c0d034b3758f9017f073997d1a89df48eef47c23932bfffe5a3c4f9d4c222ed03123d600a263d878ad90b3f28b3845b31ab75bd300015a93436533b2b4742c876315cf9f206dcfe749fd32850d4c562320ac633acde5ab6d26440f79596c5b00afad1975f8521f31b141cc163ca84595992822bcdb79b17327f283ff6d480daf9008f89cd35439636375d7a088471a8a0f3d0e927b6e00015d014f0e5979f04bdc53582a6e98c962ad2408b737ab659a2a593ee4299c10c345d76a1c4dc385ff948e563b217a3d6c7de397376ca4c95d588218c68a8e479253d864ec3ea073368bbe97805eb498b5d58b898a74aa17ffda92dfb8c9feb4b60001849c5564824181fe23f1ac765d55c8136c5a0eaa7112faed0c562fd970387f8d06003cd8b7e49969d4fca0355d9fd2593293604a57cd9394746f995c495862e5f3599b33fe9d862da30ab8b87efb51d016f6f322225e1ac54b7c82ee2ec7878e00015c9c5fda95a9320df3c5584555f2fdfbecc8022f55fc45dfa94d04dc73df5c82149e65c8ff125e158fca0ac9b95999647a6ae6499c7472cdb36fcf9902b12cb478f4431cb9b0e6c694f30166135e2af9d033fc77c4fa0f7bfd1cc277ed37aa9700013d1e86969c6712c28ba7cbc135ce80f24fcbb89fe45b26e9ca9f4a41cab976a4d69038a8c75554160280302c9aedafc8e16918ca1f76d900a8c47c90b8c94bf2e1effa7c5a6eb2da4a862e935ab0611572dd20eabfa54d9c7c9ed0a40d1d85f1000103baa0f737960e054ccd969e7ff2e9e5a27fed3213241f60930f254d969b4c19e1a8204127e51c923093150dd8cbac25e160e24d1e639e2a7cac752f9431702bdd060b599d3d3e3be3061543bf637bfd1dedb3504e2f274d97d20d4739d11690000126ecc65d6ca5999202d71d35004ae0ffe5ec161359b305e94dd57d2481142cf4f7bdd019fb51e99e5417849e39231efc9bc1f275a1c6fc3deab4a064a0e043d666f7770bf01e666b7badcadbece68acac9ef5f53add90f585724cfee7e11483200016577be3c9f52a334995aa743de9d0db0073a0610484f9d6ea112be3ebe165c0dc9307871440fc1b55400eeeb28812cf916eaa63128c008dd33896b582f6a73a6edddfa6dae45a4e12bd3daf11f4a8903d49af10c9b01f367876493212cc7843d0001be076b2bd2875bab1e2a9084022e5022a46a3395ec3ee4f6240f4bdf0b8c8130c236c4648ea062c21c2923d2855c44dd85ebb07d6b972b4a9213df857b3ff181fd59c56b34e898fb4938076be70c2b482387361e2a00390e019c34678d622fd3000159802014b1dfe0a9f3058dfb1fd2e543eaebe0f3781516341ad705b366c1b17a98fb9c881fd4d4ef0343faf5579ddb2f9e6926cd0736fe10b87f893dbb49689e682eb75f660cee9f2262ee89471875c29c4bc05ab1111f57a468f4a9f40a52860001a54b56bfc02f163162a278d19de90f2d40c5a73c6c538abfd21678db22d31969179d8143983a829384ff4ba026b05cc372a57cdec8d52e6f807514a5ab96ee60940d42b962f018f6e8b7912d0fdc9065a6d6d18ba1ac88036f9bba484d4e21320001119ee68d039f192f7c53a3a68f6ca2f40ee2218409db3cdf61ecce30f00b4e479726e2e8137a9d771728b25f7764259301eb8bd98f54492c0b6f859e0634260cf144c95d04469269a116a90d323a8811333bcd3f784f0a5d556935222c90fdc2000149f5447d31b651fa3a301bc516e2becf674c4beab746216bc2118a33c76d2d021b65c79372a1c800e7d6b589889b484e8a7f4110126bf53c749f866f9e740c6c806d65bbac9aaf746e28072dcd1207ee4797c0f885bc6c00e6030719b2e0c076000124b8d0985bd3be066c9cf264c2ac9de25876f02f1da892dab854eec9b26fe2c23a30e21b316c0ac7ca28b8f343b846f69a9a1d8b09ff5fb909a6f650446be959961e48159a6362dc045e86e3ca7a47381cb8d00f4d0b7c4db8e7abd2110313900001d10850d0c9aebd67b23bdeed7b790f23e289337ee907e124dcab49de26fca1e39b6c165e60eaff67569bf388cc5756cb7625dab59ce83db779edf5b499b46b4b47f89f5cdfdb112787793bba7f716d83adfa72b0155c01e30e1ab697040763bb0001292db780d350426ba3ca7c7140f2b651895284f193abafc99d1c3d43ecb86fa1ceab94f2f0f314e941029ba64283b7f6586060ddd1c3cfca4c74dc6def7f8c9fe9e41fdfcd59ac7043e0f95eb68d105fe04b85d8cf59e37685f5daadad2a4a060001110fd6563b0b48b53ca6de35e127327f0dfb8b932c51c3ae2fbed2adfe953feb41f159ddba1f31c15c8278933a5399291f3e5bb569252234f37c3aa8b6e4e35ed59dfb6949d09f014c0388d2826ec785354de719a6f81d3dddc7e1898369d9a30001302542956e02fec9dc6ed858bbb66148b96df8b80ae8ee6f0211e441d6ed89686a5db2dd55b517ba0a1d9485213ca8792e697ca9381cbb721355a92bc6cdb905aa90e3862ab2d4180cc0792efb299b65a7b50646d41c7c4dda296883a666fea800019652af8838251551e04629707d74c9a2dd9cea0d42fa506a527724c837404501ec9cde919423bd0afa6839f34fad4ef4eb35cfd625eec56e81ce14c0cce4902cc5a7def77a985acb4d3b7f6249f679d5865220e8c23048bc55c3167caaed94b20001ec72b6372ddcc532d737ec9fbf0583878202e9df9a272018c4639b2b74fbc9bde2f0d6b788282b8fd1e5e0fc5453c63cd5c6cc1812dcab57563acc3a42653002b517691886b0c0e86596bb2442ca60743e4eb04b95cdbb0770d2bf1cc4a410f70001670283921c6cc5f2cd89f4afbb1d25a6203a6c00e9d102d0a1b6efa58934cc79827e3a4657f5836eaef24325a5d5f09b8edd0fcc8e0cd7b1c3569fa02a9d0c37d1bd136731d484d3e9ceb234dbfc3175cd70084c7175dd8f3fd5fac324e8c01000019b7cf9cae95421d8e38d31a339a5c4f3fc5f4cf3ed9506cc24b1ff3efbb3697822a2b5a227685a6938fd4054b38336197e499871a32a61f7e78a7e6b1ab89847801a4510dcd71989bff06a58ff62e4ec134c5088fafca612a6b3a4db1e4ca46d00016ba2e1b738479864f9bdc252b9855aaa0867c9a6106c9fb185ab938e279e5ad84bab1d07245a92e8fe3470ae6274e43dfd41ab966a495ef0a63743b9b981b5a265982c6b6bc78f178ae966f9705dce2f35c3b7ecb83fa1b86f0831ab939e7cfb0001431ca4b6d189d34fd42a89721350b902c76a98e03f753361368f7bc78f7f7821c1d1737dce8cd6b3209caf5a578be5c6a4ca761e50204387e4ce0f892164659bd3804e5d01882fe7acd35a1c00cc62ee7a172531e6a4c7352d8db9f771f3aa6e000184dfe677a6c2ae138c9edffa689718102d29e98abfa3b63493a081e6bbb22bcc6c2ed2d097b87b413d11fbfce0e35b75e46a28880a2d416b00e3b8a1984563d189f1dde5abb807a17adfa6f4896d4190a23b7907a6feb519320d7e8f3749b11f000151e65f433e6a37ecec040edc85a073e02b6b94df386c16e7ac14b01b9bf627d0b0b478d8722f7b352793d703be3d0838a44f77c6938cdf547b2514dbf43a1bb0200c7a4015e4ce729e500585fe5ada51c11035b6937de1298aa164cbd743536f00011a31831e90ff5d99f8f1b4bd91eff3b770711d094b8a944786dfb973fe67834dc9285d928a15131110d97ecba6470b86d63f81382f0459d19e9c78e450cc46e56cb45e7d276a12752771b25fcd628e394c93ab74847d7372692b3e099875ceea0001ce41901b5e43779f0345d55ce2ed27f93c747b43467448ba1738d520e5a0f4f6f2dd3511dc2c0524f93287f2465c385f30d5e5ca7bb2842b52791ea2a7f2e5633258dda06f0067ee17736231126d623069ea58026da0621f776b7029951ee8f40001fb707c70b651f6d5d8166db07d7fe33a1c013c72d5194222e9cb6ef54f63aa74da8606b00e2bf1d8123d78cd604fe42418e9b28aacb495531d31df2c24593226fcde185a102566df5dfb4fc640bc8151b1c5c7ed68efef03d13baa6e3f46925900014f9cdd89d0dba21e30edd82ad1cd97b910811515d12bcd82194184116922424ea27bf652c102542dfb270e8c340ace0e4f05949df25acb4805a33841de45834f0bbf117a015a30930f188695957e3c73b4455fe03ba1ca5b6e12cef7c14889fa0001798bd27dcc755cf48d7254d5ed478e6e0e180f1bb6a36232b2b32af8e5f1cbbd3e174d8b8d29c510c932748639c003138d1ce29d442534fa8f98591ee33e39ce5f3cbbefbbe9e2a0317367500cf094cc5f23f9869df8bdf7b991b706f5e0506c00012cf9e6e82bdcbabc0290bff76391f34daf538dacaec34424e690ccb016126e350b772cf1f5e3a182582c0e64cc98395d9291be50c7270c12f40e16ebbd678c3205299e3a1ce4241696a83f69ab477e37a8c6637115af2f1d4445c8cc64ed7eb70001c58ac12af9a09e6bd21ec7836c4473045fd83189cfa22cdecf5ff3e6cf887ae93fd223259d4ff4c339b960ca31d2fcf3c129c85c0595a1b772c98b85fd18cb059b11d8eaf64eb2da35ecdd753eccce5f3afbc301812547fa900656a5a1332cfb0001236c953685c8198aa46412f75a742b1750ea8bd109009c2e3c073b0dfc07aad1551e3740e0bbc5384064f53c0b0b377643da7f016303a3f9d806934cf001e686aa9435d5b3a21db62a4083fe632e40814211c4619aaf080d36203267ea49f4260001a58df4fdac15b25b9749c2de1d7943d82063799a91580318eec855a383b48c34ce0e0175a1bdfde42861bf936aa0a2a933429c74545e060ee2059e8fcc56bc59bdaf76719c0688425abc12291c481196a078156dde8ff4bc9db14bebdc9f6b700001e3773242ae35828ad91e2633a251d92bae07bf8b148d53c5ffe4279f10c32b4b909fb29938a7b4d2a44bf35d5294d2dc86b027aa16c3d0cc1cbafe4798811b70da314d8504d55342229f928baf70417c00b70a889150111e2ddca6f03ddec4370001d761658d2b3a94ab46c39dd18b387b5f17b5ff73e1ab17344b0f5bb7849406b10115574c77bff8316c2ddb80947f70f59fb9afeb7915d5cf69553969f02eeb7f988f9d518b5fc0d13faba76b27ed5c8142872a3823e11041f4f067a61d5748a2000114db52348374f8348b551962941781eb57c8959f6d5eb5b775e067b574bb0dcea31a2ac7510e1b089ea2fc0120bfa36bac4b5b2535e12a6fd2276c293c8a7e1c0dcd6a0b517f124de8ac16188316fdfe01a1c7f96abb487698f009e39a2f83df0001554d41dc6f39a4ea6d3e4dd3e78ffbd312f310c84967c4f8176d18574ad14c976647da214ab42fa3ebe33d6b8c0c857a480cba1d2830b423a2168562132959814e23dca7d785144bd88ea7d7c23ad28660a0be6a22cdf10775d2489aea563d16000170ef9ff5c294864c2129859a8452f441acc517d972beba8838c2d27db3c17a936135ef34b392a07a347b4d93de1c463c692460a652278dfdd97bb8a373d2bfb2a07ac80af4e91951a6ea2c73b254ce8b7d94dcb538276ed03a1ea209637b9e2b00017f8c9e49428a15dff7f9dfcae3b53d4fe0677cc577591c5128d00ae74a14e549f9a149083be73dc2b995068aa37f639e7f8767fc63549800153d4f99cd0f4acc0d031669b667a071d7578474843cd9b722f1c1953a754786ef0ccd1a29a4e9b80001838965adcfd1a91fb5299734a05c67ec107cb5b9b13f70cd5437cf1a0af87c68f17a4e6953aaba8e42c84928b4ed5508880daff1342b4a142f002eb79bee8662251239f612d69f9552682f9b2ebc32c4c69899b6b99361a20720701d1c9fc3cf000172fa4a1baec600dc28cb4d81edf53d7a4b6cbd8085c5b1cd56da6c8a72a3531e9dcfb28ce0e6d3d4c0774c43dbee32d6679fedaab60c1d656102a1b008b906cfa1d4e054753059dafe169f3688d4703de42e78175f185a7f353163d0f9cf34d60001df7eb90724372b5cfcd03b32d4a79628d123da6cea4c2931b2203c23e2eb227879d1bceb705c8824562ea0e4b04efba294a2a384c86c1e16513f0cf930910b7cd24cb912a4567ee529ec0deed9cd109604deae9a8efa417c472253d3bf1e78750001ba7a880639c38c59796b4f523008f67e0ab974b8259c20537e4cace45838ccaa55cae91f2ad815b8537dd3164796c2985635db835ed7cfb6036abf7a6c7a54990ca1b9e36ae8364d85458bfd2aa11a0bdc2d18724c63e9a2f2ae2e61ab47768c00019e281395069a108a5bfdb22fc54429b3bf5b39d55ad2ed48a60911379a1804a2c50794af3f3c593e8ee69c2503fcfab395b8ad53122fb9919cd09352f80368d272d4632baaff928efb82c441ec400c9dfb40250b2fb13405d7b473ae059359360001a2992ece55049dcf1cdf94ee78b0779f0c5687f513de2dc342f838045f4f7a7a2f32ece50fdd4c1610310af0ae6de1ebe34e11306cc1a8a6b533d35803bf1609374de7e982ccbcfa124dacf65322bdf7fd2277ec5bd1c4a297c9041c627bd40300018221222b20c60df8aa03c0302131f0ee9b17602494715f04c52197fdba314f4522bce2aa5507f684e09a9f60d6d4676516c15a6a22dbb68b84545f96f5a70a0c862b976c1d06f12b6b3cd6e24e0050ff994e1948c051ae3f8a89b54e1d4ba74e0001c6f9514cacfa6840b1d6a540f3cddccb3b5ebd4d42a1de605fff04b8c4c6cc6daee0d45c19120ce15dea528148367eb43e2f55e8f15ccce969670d37e53f5ea96cadcc06f20386f57c24f84e9d3769c1d68f43e4da7369ffd2bd909ca77f8019000174edaafc256cb82bd9e12fc1d8cf8c5fa9a74a4bfd695d8147740104c0e244c06a9d553667971da577f166a7ff9ae7e72c11bad135abfe6e1b4e718ee1769a37c9b90de748e3f51bd037adb56a5d1d68a625a5ea973fdd5f38b7fcf1c22cadc200013b5529047b135789f1d20f71cacac75423d05671a496843da6346e5e7f4e4922e09ec8942eaf342ff6d3a7909eec2515c5fbe4bd083d5a707717202f1b1baba5c9836d4421d60a01bd5d9ffde4dfe4fd83a27caf237bb16baa715011bb4866e800016cf442283678ee64a5eafc2e5adfd2a89bc65320bf02b5fe8f8b4bfec8bfc21cdc51c55b8201e628e71b97d27b0ef31d05a68227d8e04c2cfe8e5b9267a1da2fc86a3f832033b2f7e66ee29398a23215d12141bc2bdefe55fb6c3428c441a1fe0001330cd3f54a90f758040cb6ee44cc803f008fa885e89c9df55aeaa06b3b59d189815ae010d5d37b1a4eaf3de93e5915a78e51af21c675a73814093b0c04e5d84d9b930ab4c8e356ed9043a8ab5fa31891104d8595c623ba0dbdc42a1230e1d3fe0001a20bb9d93d6191978b532ac1803c464644578a2366f251ccf8fbef0a0b72f0a836e726048315360473384841610b0946bc29a802b680dbcf22545b5a2e342406b9664cd1b71aff920649d126e623ad7caac75e6503ec0472b90481f2d565eb590001d333327026b12e213b666d9afe19be5c6af69a85ad314170b29d69b41e225cba1657f32e214020fd02a4cf4f5f446c158d85b78124fe9411f6ea27a75a6410e0f5a57d5acf37c05b3f4eee7d5e42f5e02e89f5c451177960c011439b2ea276ed0001edcd959a886e92191952393da2a51aa719c53eba833ed24dd7de4be568bf728a95384dd48e7ea0801a44ca14dc914481f4e5de081d25659d619247688ea363822e6683ed2de3c931ff236c29ac18c9000f5cdcef843bd0ace6fce10c371b7410000100523ed2065c0e2203a5b05a6829db97cddcd2bd4460746ebc70290a6e0ecd449ce62e23150d09cca132c52524f58948d610d7f1673c58a6c674a850752f458d1b725b8c14381bfa4661951fdffb7ab054b7f03aae8122a5385b9688b5aabf880000000000000000"

var testWorker = New(workers)

func TestScore(t *testing.T) {
	tests := []*struct {
		msg    []byte
		expPoW float64
	}{
		{msg: []byte{0, 0, 0, 0, 0, 0, 0, 0}, expPoW: math.Pow(3, 1) / 8},
		{msg: []byte{203, 124, 2, 0, 0, 0, 0, 0}, expPoW: math.Pow(3, 10) / 8},
		{msg: []byte{65, 235, 119, 85, 85, 85, 85, 85}, expPoW: math.Pow(3, 14) / 8},
		{msg: make([]byte, 10000), expPoW: math.Pow(3, 0) / 10000},
	}

	for _, tt := range tests {
		pow := Score(tt.msg)
		assert.Equal(t, tt.expPoW, pow)
	}
}

func TestWorker_Mine(t *testing.T) {
	msg := append([]byte("Hello, World!"), make([]byte, NonceBytes)...)
	nonce, err := testWorker.Mine(context.Background(), msg[:len(msg)-NonceBytes], targetScore)
	require.NoError(t, err)

	// add nonce to message and check the resulting PoW score
	binary.LittleEndian.PutUint64(msg[len(msg)-NonceBytes:], nonce)
	pow := Score(msg)
	assert.GreaterOrEqual(t, pow, targetScore)
}

func TestWorker_Small_Message_Mine(t *testing.T) {
	msg, err := hex.DecodeString(SmallMessage)
	require.NoError(t, err)
	nonce, err := testWorker.Mine(context.Background(), msg[:len(msg)-NonceBytes], targetScore)
	require.NoError(t, err)

	// add nonce to message and check the resulting PoW score
	binary.LittleEndian.PutUint64(msg[len(msg)-NonceBytes:], nonce)
	pow := Score(msg)
	assert.GreaterOrEqual(t, pow, targetScore)
}

func TestWorker_Large_Message_Mine(t *testing.T) {
	msg, err := hex.DecodeString(BigMessage)
	require.NoError(t, err)
	nonce, err := testWorker.Mine(context.Background(), msg[:len(msg)-NonceBytes], targetScore)
	require.NoError(t, err)

	// add nonce to message and check the resulting PoW score
	binary.LittleEndian.PutUint64(msg[len(msg)-NonceBytes:], nonce)
	pow := Score(msg)
	assert.GreaterOrEqual(t, pow, targetScore)
}

func TestWorker_Cancel(t *testing.T) {
	ctx, cancel := context.WithCancel(context.Background())
	defer cancel()

	var err error
	go func() {
		_, err = testWorker.Mine(ctx, nil, math.MaxInt32)
	}()
	time.Sleep(10 * time.Millisecond)
	cancel()

	assert.Eventually(t, func() bool { return err == ErrCancelled }, time.Second, 10*time.Millisecond)
}

const benchBytesLen = 1600

func BenchmarkScore(b *testing.B) {
	data := make([][]byte, b.N)
	for i := range data {
		data[i] = make([]byte, benchBytesLen)
		if _, err := rand.Read(data[i]); err != nil {
			b.Fatal(err)
		}
	}
	b.ResetTimer()

	for i := range data {
		_ = Score(data[i])
	}
}

func BenchmarkWorker(b *testing.B) {
	var (
		w       = New(1)
		digest  = make([]byte, crypto.BLAKE2b_256.Size())
		done    uint32
		counter uint64
	)
	go func() {
		_, _ = w.Worker(digest[:], 0, math.MaxInt32, &done, &counter)
	}()
	b.ResetTimer()
	for atomic.LoadUint64(&counter) < uint64(b.N) {
	}
	atomic.StoreUint32(&done, 1)
}

func TestSimpleMessage(t *testing.T) {
	signedTxPayload := oneInputOutputTransaction()

	message := Message{
		NetworkID: 1,
		Parent1:   [MessageIDLength]byte{},
		Parent2:   [MessageIDLength]byte{},
		Payload:   signedTxPayload,
		Nonce:     0,
	}

	bytes, err := message.Serialize(DeSeriModeNoValidation)
	must(err)
	fmt.Printf("%x\n", bytes)
	fmt.Printf("bytes length is %d\n", len(bytes))
	assert.NotEmpty(t, bytes)
}

func Test100Message(t *testing.T) {
	inputs := createInputs(100)
	outputs := createOutputs(1)
	unlock_blocks := createUnlockBlocks(1)

	txPayload := &Transaction{
		Essence: &TransactionEssence{
			Inputs:  inputs,
			Outputs: outputs,
			Payload: nil,
		},
		UnlockBlocks: unlock_blocks,
	}

	message := Message{
		NetworkID: 1,
		Parent1:   [MessageIDLength]byte{},
		Parent2:   [MessageIDLength]byte{},
		Payload:   txPayload,
		Nonce:     0,
	}

	bytes, err := message.Serialize(DeSeriModeNoValidation)
	must(err)
	fmt.Printf("%x\n", bytes)
	fmt.Printf("bytes length is %d\n", len(bytes))
	assert.NotEmpty(t, message)
}

func createUnlockBlocks(n int) Serializables {
	var unlockBlocks Serializables
	for i := 0; i < n; i++ {
		block := SignatureUnlockBlock{
			Signature: func() Serializable {
				edSig, _ := randEd25519Signature()
				return edSig
			}(),
		}
		unlockBlocks = append(unlockBlocks, &block)
	}
	return unlockBlocks
}

func createOutputs(n int) Serializables {
	var outputs Serializables
	for i := 0; i < n; i++ {
		output := SigLockedSingleOutput{
			Address: func() Serializable {
				edAddr, _ := randEd25519Addr()
				return edAddr
			}(),
			Amount: uint64(i),
		}
		outputs = append(outputs, &output)
	}
	fmt.Println()
	return outputs
}

func createInputs(n int) Serializables {
	var inputs Serializables
	for i := 0; i < n; i++ {
		input := UTXOInput{
			TransactionID:          rand32ByteHash(),
			TransactionOutputIndex: uint16(i),
		}
		inputs = append(inputs, &input)
	}
	return inputs
}
